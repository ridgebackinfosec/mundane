# Mundane Workflow Mappings
#
# Maps Nessus plugin IDs to verification workflow steps.
# These workflows are display-only and provide structured guidance
# for verifying specific vulnerabilities.
#
# Format:
#   plugin_id: Single ID ("57608") or comma-separated ("57608,10079,12345")
#   workflow_name: Human-readable name for the workflow
#   description: Brief description of what is being verified
#   steps: List of verification steps with commands and notes
#   references: List of reference URLs
# 
  # - plugin_id: ""
  #   workflow_name: ""
  #   description: ""
  #   steps:
  #     - title: ""
  #       commands:
  #         - ""
  #       notes: ""

  #   references:
  #     - ""

version: "1.0"

workflows:
  - plugin_id: "10759"
    workflow_name: "Web Server HTTP Header Internal IP Disclosure"
    description: "Occurs when a web server includes internal IP addresses in HTTP response headers, unintentionally exposing internal network details that can aid attackers in mapping or targeting internal infrastructure."
    steps:
      - title: "Try with NSE script"
        commands:
          - "sudo nmap --script http-internal-ip-disclosure --script-args http-internal-ip-disclosure.path=/ $IP -p $PORT"
        notes: ""

      - title: "Use Burp's Repeater"
        commands:
          - "Manually build and run a request using Burp's repeater"
        notes: "Manually exploit this via Burps Repeater functionality and forced the use of HTTP/1.0 without a Host header defined."

    references:
      - "https://www.tenable.com/plugins/nessus/10759"

  # SMB Signing Not Required (Plugin 57608)
  - plugin_id: "57608"
    workflow_name: "SMB Signing Not Required"
    description: "Remote SMB server does not enforce message signing"
    steps:
      - title: "Verify SMB signing is disabled"
        commands:
          - "netexec smb <target> -u <username> -p <password>"
          - "nmap -p445 --script smb-security-mode <target>"
        notes: "Check output for 'Message signing: disabled' or similar"

      - title: "Test NTLM relay attack feasibility"
        commands:
          - "responder -I <interface> -A"
          - "ntlmrelayx.py -tf targets.txt -smb2support"
        notes: "Attempt to relay captured NTLM authentication"

      - title: "Enumerate accessible shares"
        commands:
          - "netexec smb <target> -u <username> -p <password> --shares"
          - "smbclient -L //<target> -U <username>"
        notes: "List available SMB shares and permissions"

    references:
      - "https://www.tenable.com/plugins/nessus/57608"
      - "https://attack.mitre.org/techniques/T1557/001/"

  - plugin_id: "10114"
    workflow_name: "ICMP Timestamp Request Remote Date Disclosure"
    description: "Occurs when a system responds to ICMP timestamp requests with its local time, allowing remote attackers to infer the deviceâ€™s timezone, system clock, and potentially aiding in reconnaissance or timing attacks."
    steps:
      - title: "Check request and response types"
        commands:
          - "nping --icmp-type 13 IP_address"
        notes: "You're looking to see if the ICMP timestamp request was coded as message type 13 and the subsequent timestamp response was coded as message type 14"

    references:
      - "https://www.tenable.com/plugins/nessus/10114"
